<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PDP Gap Finder</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
    body { background: #f8f9fa; padding-top: 3rem; }
    .container { max-width: 900px; background: #fff; padding: 2.5rem 3rem; border-radius: 12px; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
    pre { background: #212529; color: #fff; padding: 1rem; border-radius: 10px; white-space: pre-wrap; max-height: 400px; overflow-y: auto;}
  </style>
</head>
<body>
  <div class="container">
    <h1>PDP Gap Finder üîç</h1>

    {% if not result %}
    <!-- Step 1: Compare PDPs -->
    <form method="POST" id="pdpForm" novalidate>
      <div class="mb-3">
        <label for="your_url" class="form-label">Your PDP URL</label>
        <input type="url" class="form-control" id="your_url" name="your_url" required placeholder="https://your-pdp.com/xyz" />
      </div>
      <div class="mb-3">
        <label for="comp_url" class="form-label">Competitor PDP URL</label>
        <input type="url" class="form-control" id="comp_url" name="comp_url" required placeholder="https://competitor.com/abc" />
      </div>
      <button type="submit" class="btn btn-primary w-100">Compare PDPs</button>
    </form>
    {% endif %}

    {% if result %}
    <!-- Step 2: Show Analysis -->
    <h3 class="mt-4">üìä Analysis Result:</h3>
    <pre>{{ result }}</pre>

    <!-- Step 3: Upload PDF and Provide Inputs -->
    <form method="POST" action="/generate_pdp" enctype="multipart/form-data" class="mt-4">
      <input type="hidden" name="previous_analysis" value="{{ result }}">

      <div class="mb-3">
        <label for="pdf_file" class="form-label">Upload Current PDP PDF</label>
        <input type="file" class="form-control" id="pdf_file" name="pdf_file" accept=".pdf" required />
      </div>

      <div class="mb-3">
        <label for="program_name" class="form-label">Program Name</label>
        <input type="text" class="form-control" id="program_name" name="program_name" placeholder="e.g. Data Science Bootcamp" required />
      </div>

      <div class="mb-3">
        <label for="seo_keywords" class="form-label">SEO Keywords</label>
        <input type="text" class="form-control" id="seo_keywords" name="seo_keywords" placeholder="e.g. data science, machine learning, bootcamp" required />
      </div>

      <button type="submit" class="btn btn-success w-100">Generate New PDP</button>
    </form>
    {% endif %}

    {% if new_pdp %}
    <h3 class="mt-5">üÜï Generated PDP Description:</h3>
    <pre>{{ new_pdp }}</pre>
    {% endif %}
  </div>

  <footer class="text-center mt-5 text-muted">&copy; 2025 PDP Gap Finder ‚Äî Flask & Gemini API</footer>
</body>
</html>
